%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This document can be formatted only with pdflatex.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% TODO use the T-CREST template here

\documentclass[11pt,twoside,a4paper]{article}
\usepackage[margin=1.1in]{geometry}

\usepackage{hyperref}
\usepackage[T1]{fontenc}
\usepackage{ae}
\usepackage[pdftex]{graphicx}
\usepackage[english]{babel}
\usepackage{latexsym,epsf,epsfig}
\usepackage{rotating,amsmath,amsfonts,amssymb,subfigure}
\usepackage{amsthm}

\usepackage{times}
\usepackage{listings}
\usepackage{longtable}
\usepackage{datetime}
\usepackage{verbatim}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{array}

\usepackage{booktabs}
\usepackage{dcolumn}

\usepackage{pslatex} % -- times instead of computer modern
\usepackage{url}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xspace}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{colortbl}
\usepackage{multicol}

\usepackage{bytefield}

% TODO move the ISA related stuff into the isa.tex file

% long immediate in second slot
\newcommand{\lconst}{\texttt{const}_{32}}
% short immediate in ALU instruction
\newcommand{\sconst}{\texttt{Constant}_{12}}
% constant in Rs2 field
\newcommand{\rconst}{\texttt{Constant}_{5}}


\newcommand{\cc}[1]{\multicolumn{1}{c}{#1}}
\newcolumntype{d}[1]{D{.}{.}{#1}}
\newcommand{\code}[1]{{\texttt{#1}}}
\newcommand{\codefoot}[1]{{\texttt{#1}}}
\newcommand{\eg}{\emph{e.g.}}
\newcommand{\ie}{\emph{i.e.}}

\usepackage{listings}
\lstset{language=C,basicstyle=\footnotesize,captionpos=b}
%% \renewcommand{\lstlistingname}{\footnotesize Listing}

\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{criterion}{Criterion}
\newtheorem{definition}{Definition}

\newcommand{\XOR}{\textasciicircum\xspace}
\newcommand{\OR}{\textbar\xspace}
\newcommand{\AND}{\&\xspace}
\newcommand{\NOT}{\texttildelow}
\newcommand{\shl}{\textless$\!$\textless\xspace}
\newcommand{\shr}{\textgreater$\!$\textgreater$\!$\textgreater\xspace}
\newcommand{\ashr}{\textgreater$\!$\textgreater\xspace}

%
% allow click-able links
%
\usepackage[open]{bookmark}
\usepackage[all]{hypcap}

% \pdfcatalog{
%  /UseNone
% }

\title{The Patmos Tool Chain Manual}

\begin{document}

%\firstpage
\maketitle

\newpage
\tableofcontents

\newpage

\cleardoublepage
%\pagenumbering{arabic}


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

% TODO needs cleanup, currently not fully up-to-date.
\input{content/overview}

% TODO organize the structure properly:
% - Make a report out of this, introduce chapters
% - Use the following structure (maybe):
%   - Platform Overview
%   - Patmos Core
%	- Architecture
%	- Simulator
%	- Synthesizing, booting
%   - Compiler Tool Chain
%	- Overview, Components
%	- Clang Frontend
%	- LLVM Backend
%	- ELF Binary
%   - WCET Analysis and WCET integration
%	- aiT
%	- Platin
%   - Installation and Usage
%	- Build script
%	- Compiler Usage
%   - Appendix
%	- ISA Reference
%	- Examples
%
% How do we organize this: We have 
%   - Components: Patmos Core, Simulator, Compiler Tool Chain, WCET Analysis, Platin, NoC, RTEMS, ...
%   - Common Structure: Overview, Description, Full Reference/Specs, Installation, Tool Usage, Examples, ...
% Do we top-level-organize by component or by structure??? Better approach is probably by Structure, 
% since some components share same specs, same build system .. -> Have main chapters for
%   - Platform Overview (big picture, all the buzzwords)
%   - More In-depth description of various components (still high-level (no technical stuff), but with all the nasty details, results ..; similar to paper style)
%   - Specifications (Common: ISA, ABI, ELF format, asm format, IO-ports, Target Triples, ..; plus component-specific: Clang Frontend, Platin
%     PML, newlib, ..)
%   - Installation and Usage: Sections for build.sh, platin, aiT, NoC?, RTEMS, Synthesizing and booting Patmos, ..
%     This should not include stuff that is already in any README.patmos file (configure-strings, list of options, ..) if possible!
%     Just the big picture, stuff that is too long for the README; the most important stuff can be repeated, plus a reference to the README.
%   - (Bigger) Usage Examples
%	- Hello world, ...
%	- Reference and describe demos in patmos-misc/demo/
%
% To conclude
% - create chapters, clean up main structure
% - move (inline) asm stuff from patmos_tr here
% - remove stuff from here that is already in READMEs and should not be repeated here (manual building without build.sh, ..)
% - move patmos-misc/doc/*.txt stuff into content, convert to tex
% - use the T-CREST template style
% - Somehow copy the ISA part from TR to here, fix formatting.
% - clean up this whole mess, make sure everything is consistent/up-to-date


% TODO this is (partially) redundant with the README.patmos files. We should put
% compile instructions only in README.patmos files and only describe the build.sh 
% script and some top-level build instructions here.
\input{content/usage}


\section*{Appendix}

\appendix

% TODO Ok, now this looks properly horrible without the two-column formatting. Needs cleanup
% and must be put into a chapter, otherwise it messes up the TOC.
% TODO we also need a good way to keep this in sync with the TR.. maybe split the TR into files 
% or export the TR as PDF and only link in the PDF here?
%\input{content/isa}

\input{content/examples}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\cleardoublepage

\nocite{Kirner:RTS2010}
\nocite{FFY05}
\nocite{patmos:ppes2011}

\bibliographystyle{plain}

\bibliography{references}

\end{document}
